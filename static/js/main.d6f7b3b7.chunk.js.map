{"version":3,"sources":["../../dbdb/index.js","app/Providers.js","shared/useDb.js","shared/index.js","app/DayPicker.js","app/TodoForm.js","app/TodoListItem.js","app/DayBrowser.js","shared/useDayBrowser.js","app/TodoList.js","shared/useTodoHistory.js","App.js","serviceWorker.js","index.js"],"names":["Dropbox","__webpack_require__","TOKEN_KEY","createJsonFile","content","fileName","arguments","length","undefined","File","JSON","stringify","type","lastModified","Date","getTime","dbdb","_ref2","client","_ref2$databaseFileNam","databaseFileName","_ref2$databaseDirecto","databaseDirectoryPath","_ref2$authRedirect","authRedirect","window","location","origin","clientId","_ref2$fetchMethod","fetchMethod","fetch_npm_browserify_default","a","_ref2$tokenKey","tokenKey","databaseFileNameWithExtension","concat","databaseFilePath","getClient","getAccessTokenFromUrl","str","ret","Object","create","trim","replace","split","forEach","param","parts","key","shift","val","join","decodeURIComponent","Array","isArray","push","parseQueryString","hash","access_token","authUrl","fetch","getAuthenticationUrl","createClient","sessionToken","sessionStorage","getItem","accessToken","setItem","logOutDropbox","removeItem","readDatabase","Promise","resolve","error","filesSearch","path","query","then","_ref4","matches","databaseFile","slicedToArray","filesDownload","metadata","path_display","r","fileReader","FileReader","onload","parse","this","result","readAsText","fileBlob","console","warn","saveDatabase","_ref3","data","databaseName","_ref","file","filesUpload","contents","mode","uploadFile","Store","createContext","reducer","oldState","newState","objectSpread","db","dbdbdb","process","DropboxProvider","children","react_default","createElement","Providers_Dropbox","Provider","value","StoreProvider","currentDay","_useState","useState","_useState2","database","setDatabase","useContext","_useState3","_useState4","databaseFetched","setDatabaseFetched","_useReducer","useReducer","moment","_useReducer2","state","setState","useEffect","store","AppProviders","restProps","objectWithoutProperties","useDb","user","setUser","setClient","usersGetCurrentAccount","history","pushState","document","title","logout","DEFAULT_TODOS","DB_TODOS_KEY","DB_TODOS_HISTORY_KEY","everyDay","dayNamesEnglish","DAYS","freeze","reduce","acc","d","index","defineProperty","getDay","day","ALL_DAYS_SELECTED","map","getTodoHistory","asyncToGenerator","regenerator_default","mark","_callee","_useDb","remoteDatabase","localDatabase","wrap","_context","prev","next","sent","localForage","abrupt","t0","stop","apply","formatDate","date","parsedDate","year","month","useGlobalState","getTodos","_callee2","_useDb2","_context2","todos","useFilters","filters","currentFilters","setFilters","isFilterActive","name","includes","toggleFilter","filter","f","removeFilter","toConsumableArray","addFilter","keys","getTodoFilters","today","days","generateTodayFilter","messages","allDaysLabel","DayPicker","defaultSelectedDays","onSetSelectedDays","selectedDays","setSelectedDays","isDaySelected","allDaysChecked","every","syncDays","nextDays","toggleCheckDay","target","checked","onChange","editLabel","saveLabel","todoTextPlaceholder","TodoForm","cancel","todo","save","_ref$defaultValue","defaultValue","setValue","onSubmit","e","preventDefault","text","autoFocus","className","placeholder","onClick","deleteLabel","generateAriaLabelForDeleteButton","generateAriaLabelForTodo","generateAriaLabelForEditTodoButton","TodoListItem","isCompleted","toggleTodo","removeTodo","updateTodo","isEditing","setIsEditing","setNotEditing","update","style","textDecoration","aria-label","DayBrowser","_useDayBrowser","_useGlobalState","setDay","goToNextDay","add","goToPreviousDay","subtract","goToToday","useDayBrowser","format","TodoList","_ref$defaultTodos","defaultTodos","defaultHistory","defaultDay","_useTodoList","setTodos","getFilters","get","_useFilters","filterProps","activeFilters","k","filteredTodos","t","allTodos","newTodo","newTodos","id","todoId","addTodo","generateId","i","makeUniqueIdGenerator","useTodoList","_useTodoHistory","lastHistory","setHistory","isEqual","isEmpty","getDayHistory","isCompletedForDay","toggleTodoForDay","existingDayHistory","nextTodoHistory","nextHistory","useTodoHistory","isTodoCompleted","background","padding","float","todosResource","createResource","todosHistoryResource","Fallback","LiveTodoList","read","User","display_name","href","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","ReactDOM","render","props","App_User","react","fallback","App_Fallback","App_LiveTodoList","getElementById","publicUrl","URL","addEventListener","response","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"mPAsCA,IAAAA,EAAcC,EAAQ,IAASD,QAE/BE,EAAA,YAEA,SAAAC,EAAAC,GACA,IAAAC,EAAAC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,eACA,WAAAG,KAAA,CAAAC,KAAAC,UAAAP,EAAA,SAAAC,EAAA,CACAO,KAAA,YACAC,cAAA,IAAAC,MAAAC,YA4He,IAAAC,EA7Gf,SAAcC,GACd,IAWAC,EAXAC,EAAAF,EAAAG,iBACAA,OAAA,IAAAD,EAAA,OAAAA,EACAE,EAAAJ,EAAAK,sBACAA,OAAA,IAAAD,EAAA,IAAAA,EACAE,EAAAN,EAAAO,aACAA,OAAA,IAAAD,EAAAE,OAAAC,SAAAC,OAAAJ,EACAK,EAAAX,EAAAW,SACAC,EAAAZ,EAAAa,YACAA,OAAA,IAAAD,EAAmDE,EAAAC,EAAKH,EACxDI,EAAAhB,EAAAiB,SACAA,OAAA,IAAAD,EAAA/B,EAAA+B,EAEAE,EAAA,GAAAC,OAAAhB,EAAA,SACAiB,EAAA,GAAAD,OAAAd,GAAAc,OAAAD,GAEA,SAAAG,IACA,OAAApB,EAGA,SAAAqB,IACA,OA/EA,SAAAC,GACA,IAAAC,EAAAC,OAAAC,OAAA,MAEA,wBAAAH,EACAC,GAGAD,IAAAI,OAAAC,QAAA,kBAMAL,EAAAM,MAAA,KAAAC,QAAA,SAAAC,GACA,IAAAC,EAAAD,EAAAH,QAAA,WAAAC,MAAA,KAGAI,EAAAD,EAAAE,QACAC,EAAAH,EAAA1C,OAAA,EAAA0C,EAAAI,KAAA,UAAA7C,EACA0C,EAAAI,mBAAAJ,GAGAE,OAAA5C,IAAA4C,EAAA,KAAAE,mBAAAF,QAEA5C,IAAAiC,EAAAS,GACAT,EAAAS,GAAAE,EACKG,MAAAC,QAAAf,EAAAS,IACLT,EAAAS,GAAAO,KAAAL,GAEAX,EAAAS,GAAA,CAAAT,EAAAS,GAAAE,KAGAX,GAtBAA,EAqEAiB,CAAAjC,OAAAC,SAAAiC,MAAAC,aA8EA,OACAC,QA1DA,IAAA7D,EAAA,CACA4B,WACAkC,MAAa/B,EAAAC,IAEb+B,qBAAAvC,GAuDAwC,aA7EA,WACA,IAAAC,EAAAC,eAAAC,QAAAjC,GACAkC,EAAAH,GAAA1B,IAMA,IAJA0B,GAAAG,GACAF,eAAAG,QAAAnC,EAAAkC,GAGAA,EAKA,OAJAlD,EAAA,IAAAlB,EAAA,CACAoE,cACAN,MAAAhC,IAEAQ,KAiEAA,YACAgC,cAtDA,WACApD,OAAAV,EACAiB,OAAAyC,eAAAK,WAAArC,IAqDAsC,aAxCA,WACA,WAAAC,QAAA,SAAAC,EAAAC,GACAzD,GACAwD,IAGAxD,EAAA0D,YAAA,CACAC,KAAA,GACAC,MAAA3C,IACO4C,KAAA,SAAAC,GACP,IAAAC,EAAAD,EAAAC,QAEA,GAAAA,KAAA1E,OAAA,CACA,IACA2E,EADyBxC,OAAAyC,EAAA,EAAAzC,CAAcuC,EAAA,GACvC,GAEA/D,EAAAkE,cAAA,CACAP,KAAAK,EAAAG,SAAAC,eACWP,KAAA,SAAAQ,GACX,IAAAC,EAAA,IAAAC,WAEAD,EAAAE,OAAA,WACAhB,EAAAhE,KAAAiF,MAAAC,KAAAC,UAGAL,EAAAM,WAAAP,EAAAQ,iBAGAC,QAAAC,KAAA,eACAvB,SAYAwB,aAnDA,SAAAC,GACA,IAAAC,EAAAD,EAAAC,KACAC,EAAAF,EAAAE,cAnEA,SAAAC,GACA,IAAApF,EAAAoF,EAAApF,OACA2D,EAAAyB,EAAAzB,KACA0B,EAAAD,EAAAC,KACArF,KAAAsF,YAAA,CACA3B,OACA4B,SAAAF,EACAG,KAAA,cA6DAC,CAAA,CACAzF,SACAqF,KAAApG,EAAAiG,EAAAC,GACAxB,KAAAxC,OC9GauE,EAAQC,0BACfC,EAAU,SAACC,EAAUC,GAAX,OAAAtE,OAAAuE,EAAA,EAAAvE,CAAA,GAA8BqE,EAAaC,IAE9ChH,EAAU6G,0BAGjBlF,EAASF,OAAOC,SAASC,OAEzBuF,EAAKC,EAAO,CAChBvF,SAAU,kBACVJ,aAHgB,GAAAY,OAAMT,GAANS,OAFAgF,iBAQlB,SAASC,EAATf,GAAuC,IAAZgB,EAAYhB,EAAZgB,SACzB,OAAOC,EAAAvF,EAAAwF,cAACC,EAAQC,SAAT,CAAkBC,MAAOT,GAAKI,GAGvC,SAASM,EAAT3G,GAAiD,IAAxBqG,EAAwBrG,EAAxBqG,SAAUO,EAAc5G,EAAd4G,WAAcC,EACfC,mBAAS,IADMC,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GACxCG,EADwCD,EAAA,GAC9BE,EAD8BF,EAAA,GAEvCxD,EAAiB2D,qBAAWnI,GAA5BwE,aAFuC4D,EAGDL,oBAAS,GAHRM,EAAA3F,OAAAyC,EAAA,EAAAzC,CAAA0F,EAAA,GAGxCE,EAHwCD,EAAA,GAGvBE,EAHuBF,EAAA,GAAAG,EAIrBC,qBAAW3B,EAAS,CAC5Ce,WAAYA,GAAca,QALmBC,EAAAjG,OAAAyC,EAAA,EAAAzC,CAAA8F,EAAA,GAIxCI,EAJwCD,EAAA,GAIjCE,EAJiCF,EAAA,GAQ/CG,oBAAU,WACHR,GACH9D,IAAeO,KAAK,SAAAmC,GAClBgB,EAAYhB,GACZqB,GAAmB,OAKzB,IAAMQ,EAAQ,CAAEH,QAAOC,WAAUZ,YACjC,OAAOV,EAAAvF,EAAAwF,cAACZ,EAAMc,SAAP,CAAgBC,MAAOoB,GAAQzB,GAGzB,SAAS0B,EAAT7C,GAAkD,IAA1BmB,EAA0BnB,EAA1BmB,SAAa2B,EAAavG,OAAAwG,EAAA,EAAAxG,CAAAyD,EAAA,cAC/D,OACEoB,EAAAvF,EAAAwF,cAACH,EAAD,KACEE,EAAAvF,EAAAwF,cAACI,EAAkBqB,EAAY3B,ICjD9B,SAAS6B,IACd,IAAMjC,EAAKiB,qBAAWnI,GACdsC,EAA2C4E,EAA3C5E,UAAW0B,EAAgCkD,EAAhClD,aAAcM,EAAkB4C,EAAlB5C,cAFXwD,EAGEC,mBAAS,MAHXC,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GAGfsB,EAHepB,EAAA,GAGTqB,EAHSrB,EAAA,GAAAI,EAIML,mBAASzF,KAAe0B,KAJ9BqE,EAAA3F,OAAAyC,EAAA,EAAAzC,CAAA0F,EAAA,GAIflH,EAJemH,EAAA,GAIPiB,EAJOjB,EAAA,GAwBtB,OAlBAS,oBACE,WACE5H,GAAUA,EAAOqI,yBAAyBxE,KAAKsE,GAC/C5H,OAAO+H,QAAQC,UACb,GACAC,SAASC,MACTvC,gBAGJ,CAAClG,IASIwB,OAAAuE,EAAA,EAAAvE,CAAA,GACFwE,EADL,CAEEhG,SACA0I,OATF,WACEP,EAAQ,MACRC,EAAU,MACVhF,KAOA8E,+CCxBG,IAAMS,EAAgB,GAChBC,EAAe,QACfC,EAAuB,UAGvBC,EAAW,WAQXC,EAAkB,CADT,SANA,SACC,UACE,YACD,WACF,SACE,YAWXC,EAAOxH,OAAOyH,OACzBF,EAAgBG,OAAO,SAACC,EAAKC,EAAGC,GAAT,OAAA7H,OAAAuE,EAAA,EAAAvE,CAAA,GAAyB2H,EAAzB3H,OAAA8H,EAAA,EAAA9H,CAAA,GAA+B4H,EAAIC,KAAU,KAEzDE,EAAS,SAAAC,GAAG,OAAIR,EAAKQ,IACrBC,EAAoBV,EAAgBW,IAAIH,GAW9C,IAAMI,EAAc,eAAAvE,EAAA5D,OAAAoI,EAAA,EAAApI,CAAAqI,EAAA/I,EAAAgJ,KAAG,SAAAC,IAAA,IAAAC,EAAA1G,EAAAyD,EAAAkD,EAAAC,EAAArC,EAAA,OAAAgC,EAAA/I,EAAAqJ,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAN,EACH/B,IAAjB3E,EADoB0G,EACpB1G,aADoB8G,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGHhH,IAHG,cAGpByD,EAHoBqD,EAAAG,KAIpBN,EAAiBlD,GAAYA,EAASuB,QAJlB8B,EAAAE,KAAA,EAKEE,IAAYvH,QAAQ4F,GALtB,UAKpBqB,EALoBE,EAAAG,KAMpB1C,EAAQoC,GAAkBC,EANN,CAAAE,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,GAQlBE,IAAYrH,QAAQ0F,EAAsB,IARxB,eAAAuB,EAAAK,OAAA,SASjB,IATiB,eAAAL,EAAAK,OAAA,SAWnB5C,GAXmB,QAAAuC,EAAAC,KAAA,GAAAD,EAAAM,GAAAN,EAAA,kCAAAA,EAAAO,SAAAZ,EAAArF,KAAA,aAAH,yBAAAU,EAAAwF,MAAAlG,KAAAtF,YAAA,GAepB,SAASyL,EAAWC,GACzB,IAAMC,EAAavD,IAAOsD,GACpBE,EAAOD,EAAWC,OAClBC,EAAQF,EAAWE,QACnBzB,EAAMuB,EAAWD,OACvB,SAAA5J,OAAU+J,EAAV,KAAA/J,OAAmBsI,EAAnB,KAAAtI,OAA0B8J,GAGrB,SAASE,IACd,OAAOjE,qBAAWvB,GAGb,IAAMyF,EAAQ,eAAApL,EAAAyB,OAAAoI,EAAA,EAAApI,CAAAqI,EAAA/I,EAAAgJ,KAAG,SAAAsB,IAAA,IAAAC,EAAA/H,EAAAyD,EAAAkD,EAAAC,EAAArC,EAAA,OAAAgC,EAAA/I,EAAAqJ,KAAA,SAAAmB,GAAA,cAAAA,EAAAjB,KAAAiB,EAAAhB,MAAA,cAAAe,EACGpD,IAAjB3E,EADc+H,EACd/H,aADcgI,EAAAjB,KAAA,EAAAiB,EAAAhB,KAAA,EAGGhH,IAHH,cAGdyD,EAHcuE,EAAAf,KAIdN,EAAiBlD,GAAYA,EAASwE,MAJxBD,EAAAhB,KAAA,EAKQE,IAAYvH,QAAQ2F,GAL5B,UAKdsB,EALcoB,EAAAf,KAMd1C,EAAQoC,GAAkBC,EANZ,CAAAoB,EAAAhB,KAAA,gBAAAgB,EAAAhB,KAAA,GAQZE,IAAYrH,QAAQyF,EAAcD,GARtB,eAAA2C,EAAAb,OAAA,SAUb5C,GAASc,GAVI,QAAA2C,EAAAjB,KAAA,GAAAiB,EAAAZ,GAAAY,EAAA,kCAAAA,EAAAX,SAAAS,EAAA1G,KAAA,aAAH,yBAAA3E,EAAA6K,MAAAlG,KAAAtF,YAAA,GAcd,SAASoM,IAAyB,IAAdC,EAAcrM,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,GAAIwH,EACFC,mBAAS4E,GADP3E,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GAChC8E,EADgC5E,EAAA,GAChB6E,EADgB7E,EAAA,GAMjC8E,EAAiB,SAAAC,GAAI,OAAIH,EAAeI,SAASD,IAIvD,MAAO,CACLJ,UACAC,iBACAE,iBACAG,aAPmB,SAAAF,GAAI,OACvBD,EAAeC,GAJI,SAAAA,GAAI,OACvBF,EAAWD,EAAeM,OAAO,SAAAC,GAAC,OAAIA,IAAMJ,KAGrBK,CAAaL,GALpB,SAAAA,GAAI,OAAIF,EAAU,GAAAzK,OAAAM,OAAA2K,EAAA,EAAA3K,CAAKkK,GAAL,CAAqBG,KAKXO,CAAUP,IAOtDF,WAAY,SAAAF,GAAO,OAAIE,EAAWnK,OAAO6K,KAAKZ,MAI3C,IAQMa,EAAiB,WAAkB,IAAf9C,GAAepK,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAP,IAARoK,IAC/B,OAAOhI,OAAA8H,EAAA,EAAA9H,CAAA,GALG,MAJuB,eAAC+K,EAADnN,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAASoI,MAASgC,MAAlB,OAA4B,SAAAvE,GAC7D,OAD2EA,EAAXuH,KACpDV,SAASS,IASZE,CAAoBjD,iBCzGlBkD,EAAW,CACtBC,aAAc,wBAGD,SAASC,GAATxH,GAA+D,IAA1CyH,EAA0CzH,EAA1CyH,oBAAqBC,EAAqB1H,EAArB0H,kBAAqBlG,EACpCC,mBAASgG,GAD2B/F,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GACrEmG,EADqEjG,EAAA,GACvDkG,EADuDlG,EAAA,GAEtEmG,EAAgB,SAAAzD,GAAG,OAAIuD,EAAajB,SAASvC,EAAOC,KACpD0D,EAAiBzD,EAAkB0D,MAAM,SAAA3D,GAAG,OAChDuD,EAAajB,SAAStC,KAExB,SAAS4D,EAASC,GAChBL,EAAgBK,GAChBP,EAAkBO,GAEpB,SAASC,EAATvN,GAAoC,IAAVwN,EAAUxN,EAAVwN,OAClB/D,EAAMR,EAAKuE,EAAO9G,OAOxB2G,EALKH,EAAcM,EAAO9G,OAGbsG,EAAaf,OAAO,SAAA5C,GAAC,OAAIA,IAAMI,IAFlC,GAAAtI,OAAAM,OAAA2K,EAAA,EAAA3K,CAAOuL,GAAP,CAAqBvD,KAMjC,OACEnD,EAAAvF,EAAAwF,cAAA,gBACED,EAAAvF,EAAAwF,cAAA,qBACAD,EAAAvF,EAAAwF,cAAA,aACED,EAAAvF,EAAAwF,cAAA,SACE5G,KAAK,WACL+G,MAAOqC,EACP0E,QAASN,EACTO,SAAU,kBAAML,EAASF,EAAiB,GAAKzD,MAEhDiD,EAASC,cATd,iBAYG5D,EAAgBW,IAAI,SAAAF,GAAG,OACtBnD,EAAAvF,EAAAwF,cAAA,SAAOtE,IAAKwH,GACVnD,EAAAvF,EAAAwF,cAAA,SACE5G,KAAK,WACL+G,MAAO+C,EACPgE,QAASP,EAAczD,GACvBiE,SAAUH,IAEX9D,MCnDJ,IAEMkD,GAAW,CACtBgB,UAAW,OACXC,UAAW,OACXC,oBAAqB,oBAGR,SAASC,GAATzI,GAA6D,IAAzC0I,EAAyC1I,EAAzC0I,OAAQC,EAAiC3I,EAAjC2I,KAAMC,EAA2B5I,EAA3B4I,KAA2BC,EAAA7I,EAArB8I,oBAAqB,IAAAD,EAAN,GAAMA,EAAArH,EAChDC,mBAASqH,GADuCpH,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GACnEH,EADmEK,EAAA,GAC5DqH,EAD4DrH,EAAA,GAAAI,EAElCL,mBACtCkH,EAAOA,EAAKvB,KAAO/C,GAHqDtC,EAAA3F,OAAAyC,EAAA,EAAAzC,CAAA0F,EAAA,GAEnE6F,EAFmE5F,EAAA,GAErD6F,EAFqD7F,EAAA,GAgB1E,OACEd,EAAAvF,EAAAwF,cAAA,QAAM8H,SAXa,SAAAC,GACnBA,EAAEC,iBACG7H,IACLuH,EAAK,CACHO,KAAM9H,EACN+F,KAAMO,IAERoB,EAAS,OAKP9H,EAAAvF,EAAAwF,cAAA,wBAEED,EAAAvF,EAAAwF,cAAA,SACEkI,WAAS,EACT9O,KAAK,OACL+O,UAAU,QACVC,YAAahC,GAASkB,oBACtBnH,MAAOA,EACPgH,SAAU,SAAAY,GAAC,OAAIF,EAASE,EAAEd,OAAO9G,aAGlCA,GACDJ,EAAAvF,EAAAwF,cAACsG,GAAD,CACEC,oBAAqBE,EACrBD,kBAAmBE,IAGvB3G,EAAAvF,EAAAwF,cAAA,UAAQ5G,KAAK,UAAUgN,GAASiB,aAC7BO,GAAgB7H,EAAAvF,EAAAwF,cAAA,UAAQqI,QAASb,GAAjB,WC5ClB,IAAMpB,GAAW,CACtBgB,UAAW,OACXkB,YAAa,UAGFC,GAAmC,SAAAzJ,GAAA,IAAGmJ,EAAHnJ,EAAGmJ,KAAH,SAAArN,OAC3CwL,GAASkC,YADkC,KAAA1N,OACnBqN,IAIhBO,GAA2B,SAAA/O,GAAA,IAAGwO,EAAHxO,EAAGwO,KAAH,SAAArN,OAFN,OAEM,KAAAA,OACbqN,EADa,KAAArN,OADN,iBAGrB6N,GAAqC,SAAA9J,GAAA,IAAGsJ,EAAHtJ,EAAGsJ,KAAH,cAAArN,OAAsBqN,IAEzD,SAASS,GAATlL,GAMZ,IALDmL,EAKCnL,EALDmL,YACAlB,EAICjK,EAJDiK,KACAmB,EAGCpL,EAHDoL,WACAC,EAECrL,EAFDqL,WACAC,EACCtL,EADDsL,WACCxI,EACiCC,oBAAS,GAD1CC,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GACMyI,EADNvI,EAAA,GACiBwI,EADjBxI,EAAA,GAGKyI,EAAgB,kBAAMD,GAAa,IACzC,OAAID,EAEAhJ,EAAAvF,EAAAwF,cAACuH,GAAD,CACEE,KAAMA,EACNC,KAAM,SAAAwB,GACJJ,EAAW5N,OAAAuE,EAAA,EAAAvE,CAAA,GACNuM,EACAyB,IAELD,KAEFrB,aAAcH,EAAKQ,KACnBT,OAAQyB,IAKZlJ,EAAAvF,EAAAwF,cAAA,OACEmJ,MAAO,CACLC,eAAgBT,EAAc,eAAiB,KAGjD5I,EAAAvF,EAAAwF,cAAA,SACEqJ,aAAYb,GAAyBf,GACrCrO,KAAK,WACL8N,QAASyB,EACTxB,SAAUyB,IAEXnB,EAAKQ,KAENlI,EAAAvF,EAAAwF,cAAA,WACED,EAAAvF,EAAAwF,cAAA,UACEqJ,aAAYZ,GAAmChB,GAC/CY,QAnCW,kBAAMW,GAAa,KAqC7B5C,GAASgB,WAEZrH,EAAAvF,EAAAwF,cAAA,UACEqJ,aAAYd,GAAiCd,GAC7CY,QAAS,kBAAMQ,EAAWpB,KAEzBrB,GAASkC,eCjEL,SAASgB,KAAa,IAE3BjJ,EADUuE,IAAVxD,MACAf,WAF2BkJ,ECA9B,WAA8CzQ,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAVoI,MAAU,IAAAsI,EACvB5E,IAApBxD,EAD2CoI,EAC3CpI,MAAOC,EADoCmI,EACpCnI,SACPhB,EAAee,EAAff,WACFoJ,EAAS,SAAAvG,GAAG,OAAI7B,EAAS,CAAEhB,WAAY6C,KAI7C,MAAO,CACLwG,YAJkB,kBAAMD,EAAOpJ,EAAWsJ,IAAI,EAAG,SAKjDC,gBAJsB,kBAAMH,EAAOpJ,EAAWwJ,SAAS,EAAG,SAK1DC,UAJgB,kBAAML,EAAOvI,SDHqB6I,GAA5CL,EAH2BH,EAG3BG,YAAaE,EAHcL,EAGdK,gBAAiBE,EAHHP,EAGGO,UACtC,OACE/J,EAAAvF,EAAAwF,cAAA,WACED,EAAAvF,EAAAwF,cAAA,UAAQqI,QAASuB,GAAjB,QACA7J,EAAAvF,EAAAwF,cAAA,UAAQqI,QAASyB,GAAjB,SACCzJ,EAAW2J,OAAO,sBACnBjK,EAAAvF,EAAAwF,cAAA,UAAQqI,QAASqB,GAAjB,SELS,SAASO,GAATnL,GAIZ,IAAAoL,EAAApL,EAHDqL,oBAGC,IAAAD,EAHc,GAGdA,EAFDE,EAECtL,EAFDsL,eAGQ1L,GADPI,EADDuL,WAEyB1I,IAAjBjD,cACA0C,EAAUwD,IAAVxD,MACAf,EAAee,EAAff,WAHPiK,EN2GI,WAAwD,IAAnCH,EAAmCrR,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAApB,GAAIoK,EAAgBpK,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAVoI,MAAUN,EACnCL,mBAAS4J,GAD0BtJ,EAAA3F,OAAAyC,EAAA,EAAAzC,CAAA0F,EAAA,GACtDqE,EADsDpE,EAAA,GAC/C0J,EAD+C1J,EAAA,GAEvD2J,EAAa,kBAAMxE,EAAe,CAAE9C,IAAKA,EAAIuH,IAAI,UAFMC,EAGNxF,EACrDhK,OAAO6K,KAAKyE,MADNpF,EAHqDsF,EAGrDtF,eAA+BuF,GAHsBD,EAGrCrF,WAHqCnK,OAAAwG,EAAA,EAAAxG,CAAAwP,EAAA,kCAOvDE,EAAa1P,OAAA2K,EAAA,EAAA3K,CAAOkK,EAAehC,IAAI,SAAAyH,GAAC,OAAIL,IAAaK,MACzDC,EAAgB7F,EAAMS,OAAO,SAAAqF,GAAC,OAAIH,EAAc/D,MAAM,SAAAlB,GAAC,OAAIA,EAAEoF,OAiCnE,OA/BAzJ,oBACE,WACE4C,IAAYrH,QAAQyF,EAAc2C,IAEpC,CAACA,IA2BI/J,OAAAuE,EAAA,EAAAvE,CAAA,CACL+J,MAAO6F,EACPE,SAAU/F,EACV6D,WAXiB,SAAAmC,GACjB,IAAMC,EAAWjG,EAAM7B,IAAI,SAAAqE,GACzB,OAAIwD,EAAQE,KAAO1D,EAAK0D,GAAW1D,EAC5BvM,OAAAuE,EAAA,EAAAvE,CAAA,GAAKuM,EAASwD,KAEvBV,EAASW,IAOTrC,WAhBiB,SAAAuC,GACjBb,EAAStF,EAAMS,OAAO,SAAAyF,GAAE,OAAIA,IAAOC,MAgBnCxC,WAvBiB,SAAA7F,GACjB,IAAMmI,EAAQhQ,OAAA2K,EAAA,EAAA3K,CAAO+J,GACrBiG,EAASnI,GAAO4F,aAAeuC,EAASnI,GAAO4F,YAC/C4B,EAASW,IAqBTG,QA9Bc,SAAA5D,GACd,IAAM6D,EApGH,WAA0D,IAA3BH,EAA2BrS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAtB,GACrCyS,EAD2DzS,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAH,EAE5D,OAAO,WAEL,OADAyS,GAAK,EACL,GAAA3Q,OAAUuQ,EAAV,KAAAvQ,OAAgB2Q,IAgGGC,CAAsB,OAAQvG,EAAMlM,QACjDmS,EAAQ,GAAAtQ,OAAAM,OAAA2K,EAAA,EAAA3K,CAAO+J,GAAP,CAAA/J,OAAAuE,EAAA,EAAAvE,CAAA,CAAgBiQ,GAAIG,KAAiB7D,KACnD8C,EAASW,KA4BNP,GM9IDc,CAAYtB,EAAc9J,GAR5B2K,EALDV,EAKCU,SACA/F,EANDqF,EAMCrF,MACAE,EAPDmF,EAOCnF,QACAM,EARD6E,EAQC7E,aACAH,EATDgF,EASChF,eACA+F,EAVDf,EAUCe,QACAxC,EAXDyB,EAWCzB,WACAC,EAZDwB,EAYCxB,WAZD4C,ECLI,WAA6C,IAArBtB,EAAqBtR,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,GAC1C6S,EAAcvB,EADgC9J,EAEpBC,mBAAS6J,GAFW5J,EAAAtF,OAAAyC,EAAA,EAAAzC,CAAAoF,EAAA,GAE3C0B,EAF2CxB,EAAA,GAElCoL,EAFkCpL,EAAA,GAIlDc,oBAAU,WACHuK,IAAQF,EAAa3J,IAAa8J,IAAQ9J,IAC7CkC,IAAYrH,QAAQ0F,EAAsBP,KAI9C,IAAM+J,EAAgB,SAAAvH,GAAI,OAAIxC,EAAQwC,IAAS,IAoB/C,MAAO,CACLxC,UACAgK,kBArBwB,SAACZ,EAAQlI,GAAT,OACxB6I,EAAcxH,EAAWrB,IAAMsC,SAAS4F,IAqBxCa,iBAnBuB,SAACb,EAAQlI,GAChC,IAAMsB,EAAOD,EAAWrB,GACxB,GAAKsB,EAAL,CACA,IAAM0H,EAAqBH,EAAcvH,GAEnC2H,EADoBD,EAAmB1G,SAAS4F,GAElDc,EAAmBxG,OAAO,SAAAqF,GAAC,OAAIA,IAAMK,IADA,GAAAxQ,OAAAM,OAAA2K,EAAA,EAAA3K,CAEjCgR,GAFiC,CAEbd,IACtBgB,EAAWlR,OAAAuE,EAAA,EAAAvE,CAAA,GACZ8G,EADY9G,OAAA8H,EAAA,EAAA9H,CAAA,GAEdsJ,EAAO2H,IAEVR,EAAcS,EACdR,EAAWQ,MDR4CC,CACvDjC,GADMpI,EAdP0J,EAcO1J,QAASiK,EAdhBP,EAcgBO,iBAAkBD,EAdlCN,EAckCM,kBAG7BM,EAAkB,SAAA7S,GAAA,IAAG0R,EAAH1R,EAAG0R,GAAH,OAAYa,EAAkBb,EAAI9K,IAc1D,OAZAiB,oBACE,WACE5C,EAAa,CACXE,KAAM,CACJoD,UACAiD,MAAO+F,MAIb,CAAChJ,EAASgJ,IAIVjL,EAAAvF,EAAAwF,cAAA,WACED,EAAAvF,EAAAwF,cAACsJ,GAAD,MACAvJ,EAAAvF,EAAAwF,cAAA,qBAEGmF,EAAQ/B,IAAI,SAAAmC,GAAI,OACfxF,EAAAvF,EAAAwF,cAAA,SAAOtE,IAAK6J,GACTA,EACDxF,EAAAvF,EAAAwF,cAAA,SACE5G,KAAK,WACL8N,QAAS5B,EAAeC,GACxB4B,SAAU,kBAAM1B,EAAaF,SAInCxF,EAAAvF,EAAAwF,cAAA,UACGiF,EAAM7B,IAAI,SAACqE,EAAM1E,GAAP,OACThD,EAAAvF,EAAAwF,cAAA,MAAItE,IAAKqH,GACPhD,EAAAvF,EAAAwF,cAAC0I,GAAD,CACE3F,MAAOA,EACP0E,KAAMA,EACNkB,YAAa2D,EAAgB7E,GAC7BmB,WAAY,kBAAMqD,EAAiBxE,EAAK0D,GAAI9K,IAC5CwI,WAAYA,EACZC,WAAYA,OAIlB/I,EAAAvF,EAAAwF,cAAA,UACED,EAAAvF,EAAAwF,cAACuH,GAAD,CAAUG,KAAM2D,MAGpBtL,EAAAvF,EAAAwF,cAAA,OAAKmJ,MAAO,CAAEoD,WAAY,WAAYC,QAAS,GAAIC,MAAO,UACxD1M,EAAAvF,EAAAwF,cAAA,qBAAa9G,KAAKC,UAAU6R,EAAU,KAAM,IAC5CjL,EAAAvF,EAAAwF,cAAA,uBAAe9G,KAAKC,UAAU6I,EAAS,KAAM,IAC7CjC,EAAAvF,EAAAwF,cAAA,qBAAa9G,KAAKC,UAAUiI,EAAO,KAAM,OEvEnD,IAAMsL,GAAgBC,kCAAe9H,GAC/B+H,GAAuBD,kCAAetJ,GAEtCwJ,GAAW,kBAAM9M,EAAAvF,EAAAwF,cAAA,0BAEjB8M,GAAe,WACnB,IAAM7H,EAAQyH,GAAcK,OACtB/K,EAAU4K,GAAqBG,OACrC,OAAOhN,EAAAvF,EAAAwF,cAACiK,GAAD,CAAUE,aAAclF,EAAOmF,eAAgBpI,KAGlDgL,GAAO,WAAM,IAAAtJ,EACyB/B,IAAlCtF,EADSqH,EACTrH,QAAS3C,EADAgK,EACAhK,OAAQ0I,EADRsB,EACQtB,OAAQR,EADhB8B,EACgB9B,KAEjC,GAAIA,EAAM,KACA2D,EAAS3D,EAAT2D,KACR,OACExF,EAAAvF,EAAAwF,cAAA,4BACiBuF,EAAK0H,aADtB,OAEElN,EAAAvF,EAAAwF,cAAA,UAAQqI,QAASjG,GAAjB,WAKN,OAAO1I,EACL,sBAEAqG,EAAAvF,EAAAwF,cAAA,KAAGkN,KAAM7Q,GAAT,qBCrBJ,IAAM8Q,GAAcC,QACW,cAA7BnT,OAAOC,SAASmT,UAEe,UAA7BpT,OAAOC,SAASmT,UAEhBpT,OAAOC,SAASmT,SAASC,MACvB,2DA2CN,SAASC,GAAgBC,EAAOC,GAC9BC,UAAUC,cACPC,SAASJ,GACTjQ,KAAK,SAAAsQ,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiB3M,QACfsM,UAAUC,cAAcO,YAI1B1P,QAAQ2P,IACN,gHAKEV,GAAUA,EAAOW,UACnBX,EAAOW,SAASP,KAMlBrP,QAAQ2P,IAAI,sCAGRV,GAAUA,EAAOY,WACnBZ,EAAOY,UAAUR,UAO5BS,MAAM,SAAAnR,GACLqB,QAAQrB,MAAM,4CAA6CA,KChGjEoR,IAASC,OAAOzO,EAAAvF,EAAAwF,cFgCD,SAAayO,GAC1B,OACE1O,EAAAvF,EAAAwF,cAACwB,EAAD,KACEzB,EAAAvF,EAAAwF,cAAC0O,GAAD,MACA3O,EAAAvF,EAAAwF,cAAC2O,EAAA,SAAD,CAAUC,SAAU7O,EAAAvF,EAAAwF,cAAC6O,GAAD,OAClB9O,EAAAvF,EAAAwF,cAAC8O,GAAD,SErCQ,MAAS5M,SAAS6M,eAAe,SDiB1C,SAAkBtB,GACvB,GAA6C,kBAAmBC,UAAW,CAEzE,IAAMsB,EAAY,IAAIC,IAAIrP,cAAwB3F,OAAOC,SAASgT,MAClE,GAAI8B,EAAU7U,SAAWF,OAAOC,SAASC,OASvC,YARAqE,QAAQ2P,IACN,6CACAa,EACAA,EAAU7U,QAQdF,OAAOiV,iBAAiB,OAAQ,WAC9B,IAAM1B,EAAK,GAAA5S,OAAMgF,cAAN,sBAEPuN,IAgEV,SAAiCK,EAAOC,GAEtCnR,MAAMkR,GACHjQ,KAAK,SAAA4R,GAEJ,IAAMC,EAAcD,EAASE,QAAQ5E,IAAI,gBAEnB,MAApB0E,EAASG,QACO,MAAfF,IAA8D,IAAvCA,EAAYG,QAAQ,cAG5C7B,UAAUC,cAAc6B,MAAMjS,KAAK,SAAAsQ,GACjCA,EAAa4B,aAAalS,KAAK,WAC7BtD,OAAOC,SAASwV,aAKpBnC,GAAgBC,EAAOC,KAG1Ba,MAAM,WACL9P,QAAQ2P,IACN,mEArFAwB,CAAwBnC,EAAOC,GAI/BC,UAAUC,cAAc6B,MAAMjS,KAAK,WACjCiB,QAAQ2P,IACN,+GAMJZ,GAAgBC,EAAOC,MChD/BE","file":"static/js/main.d6f7b3b7.chunk.js","sourcesContent":["import _slicedToArray from \"/Users/jmhudak/_lab/ticbox/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport fetch from 'isomorphic-fetch';\n\nfunction parseQueryString(str) {\n  var ret = Object.create(null);\n\n  if (typeof str !== \"string\") {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, \"\");\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split(\"&\").forEach(function (param) {\n    var parts = param.replace(/\\+/g, \" \").split(\"=\"); // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join(\"=\") : undefined;\n    key = decodeURIComponent(key); // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n  return ret;\n}\n\nvar Dropbox = require(\"dropbox\").Dropbox;\n\nvar TOKEN_KEY = \"dbdbtoken\";\n\nfunction createJsonFile(content) {\n  var fileName = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"dbdb.json\";\n  return new File([JSON.stringify(content, null, 2)], fileName, {\n    type: \"text/json\",\n    lastModified: new Date().getTime()\n  });\n}\n\nfunction uploadFile(_ref) {\n  var client = _ref.client,\n      path = _ref.path,\n      file = _ref.file;\n  return client && client.filesUpload({\n    path: path,\n    contents: file,\n    mode: \"overwrite\"\n  });\n}\n\nfunction index(_ref2) {\n  var _ref2$databaseFileNam = _ref2.databaseFileName,\n      databaseFileName = _ref2$databaseFileNam === void 0 ? \"dbdb\" : _ref2$databaseFileNam,\n      _ref2$databaseDirecto = _ref2.databaseDirectoryPath,\n      databaseDirectoryPath = _ref2$databaseDirecto === void 0 ? \"/\" : _ref2$databaseDirecto,\n      _ref2$authRedirect = _ref2.authRedirect,\n      authRedirect = _ref2$authRedirect === void 0 ? window.location.origin : _ref2$authRedirect,\n      clientId = _ref2.clientId,\n      _ref2$fetchMethod = _ref2.fetchMethod,\n      fetchMethod = _ref2$fetchMethod === void 0 ? fetch : _ref2$fetchMethod,\n      _ref2$tokenKey = _ref2.tokenKey,\n      tokenKey = _ref2$tokenKey === void 0 ? TOKEN_KEY : _ref2$tokenKey;\n  var client;\n  var databaseFileNameWithExtension = \"\".concat(databaseFileName, \".json\");\n  var databaseFilePath = \"\".concat(databaseDirectoryPath).concat(databaseFileNameWithExtension);\n\n  function getClient() {\n    return client;\n  }\n\n  function getAccessTokenFromUrl() {\n    return parseQueryString(window.location.hash).access_token;\n  }\n\n  function createClient() {\n    var sessionToken = sessionStorage.getItem(tokenKey);\n    var accessToken = sessionToken || getAccessTokenFromUrl();\n\n    if (!sessionToken && accessToken) {\n      sessionStorage.setItem(tokenKey, accessToken);\n    }\n\n    if (accessToken) {\n      client = new Dropbox({\n        accessToken: accessToken,\n        fetch: fetchMethod\n      });\n      return getClient();\n    }\n  }\n\n  function getAuthUrl() {\n    var dbx = new Dropbox({\n      clientId: clientId,\n      fetch: fetch\n    });\n    return dbx.getAuthenticationUrl(authRedirect);\n  }\n\n  function logOutDropbox() {\n    client = undefined;\n    window.sessionStorage.removeItem(tokenKey);\n  }\n\n  function saveDatabase(_ref3) {\n    var data = _ref3.data,\n        databaseName = _ref3.databaseName;\n    uploadFile({\n      client: client,\n      file: createJsonFile(data, databaseName),\n      path: databaseFilePath\n    });\n  }\n\n  function readDatabase() {\n    return new Promise(function (resolve, error) {\n      if (!client) {\n        resolve();\n      }\n\n      client.filesSearch({\n        path: \"\",\n        query: databaseFileNameWithExtension\n      }).then(function (_ref4) {\n        var matches = _ref4.matches;\n\n        if (matches && matches.length) {\n          var _matches = _slicedToArray(matches, 1),\n              databaseFile = _matches[0];\n\n          client.filesDownload({\n            path: databaseFile.metadata.path_display\n          }).then(function (r) {\n            var fileReader = new FileReader();\n\n            fileReader.onload = function () {\n              resolve(JSON.parse(this.result));\n            };\n\n            fileReader.readAsText(r.fileBlob);\n          });\n        } else {\n          console.warn(\"no db found\");\n          resolve();\n        }\n      });\n    });\n  }\n\n  return {\n    authUrl: getAuthUrl(),\n    createClient: createClient,\n    getClient: getClient,\n    logOutDropbox: logOutDropbox,\n    readDatabase: readDatabase,\n    saveDatabase: saveDatabase\n  };\n}\n\nexport default index;","import React, {\n  createContext,\n  useReducer,\n  useState,\n  useEffect,\n  useContext,\n} from 'react';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport dbdbdb from 'dbdbdb';\n\nexport const Store = createContext();\nconst reducer = (oldState, newState) => ({ ...oldState, ...newState });\n\nexport const Dropbox = createContext();\n\nconst publicUrl = process.env.PUBLIC_URL;\nconst origin = window.location.origin;\nconst authRedirect = `${origin}${publicUrl}`;\nconst db = dbdbdb({\n  clientId: 'uaqu46389soi02n',\n  authRedirect,\n});\n\nfunction DropboxProvider({ children }) {\n  return <Dropbox.Provider value={db}>{children}</Dropbox.Provider>;\n}\n\nfunction StoreProvider({ children, currentDay }) {\n  const [database, setDatabase] = useState({});\n  const { readDatabase } = useContext(Dropbox);\n  const [databaseFetched, setDatabaseFetched] = useState(false);\n  const [state, setState] = useReducer(reducer, {\n    currentDay: currentDay || moment(),\n  });\n\n  useEffect(() => {\n    if (!databaseFetched) {\n      readDatabase().then(db => {\n        setDatabase(db);\n        setDatabaseFetched(true);\n      });\n    }\n  });\n\n  const store = { state, setState, database };\n  return <Store.Provider value={store}>{children}</Store.Provider>;\n}\n\nexport default function AppProviders({ children, ...restProps }) {\n  return (\n    <DropboxProvider>\n      <StoreProvider {...restProps}>{children}</StoreProvider>\n    </DropboxProvider>\n  );\n}\n\nAppProviders.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n","import { useContext, useEffect, useState } from 'react';\nimport { Dropbox } from 'app/Providers';\n\nexport function useDb() {\n  const db = useContext(Dropbox);\n  const { getClient, createClient, logOutDropbox } = db;\n  const [user, setUser] = useState(null);\n  const [client, setClient] = useState(getClient() || createClient());\n\n  useEffect(\n    () => {\n      client && client.usersGetCurrentAccount().then(setUser);\n      window.history.pushState(\n        {},\n        document.title,\n        process.env.PUBLIC_URL || '/'\n      );\n    },\n    [client]\n  );\n\n  function logout() {\n    setUser(null);\n    setClient(null);\n    logOutDropbox();\n  }\n\n  return {\n    ...db,\n    client,\n    logout,\n    user,\n  };\n}\n","import { useEffect, useState, useContext } from 'react';\nimport localForage from 'localforage';\nimport { Store } from 'app/Providers';\nimport { useDb } from './useDb';\nimport moment from 'moment';\n\n// Store\nexport const DEFAULT_TODOS = [];\nexport const DB_TODOS_KEY = 'todos';\nexport const DB_TODOS_HISTORY_KEY = 'history';\n\n// Day Picker\nexport const everyDay = 'everyDay';\nexport const Monday = 'Monday';\nexport const Tuesday = 'Tuesday';\nexport const Wednesday = 'Wednesday';\nexport const Thursday = 'Thursday';\nexport const Friday = 'Friday';\nexport const Saturday = 'Saturday';\nexport const Sunday = 'Sunday';\nexport const dayNamesEnglish = [\n  Sunday,\n  Monday,\n  Tuesday,\n  Wednesday,\n  Thursday,\n  Friday,\n  Saturday,\n];\nexport const DAYS = Object.freeze(\n  dayNamesEnglish.reduce((acc, d, index) => ({ ...acc, [d]: index }), {})\n);\nexport const getDay = day => DAYS[day];\nexport const ALL_DAYS_SELECTED = dayNamesEnglish.map(getDay);\n\n// Utils\nexport function makeUniqueIdGenerator(id = '', initialIndex = 0) {\n  let i = initialIndex;\n  return function() {\n    i += 1;\n    return `${id}_${i}`;\n  };\n}\n\nexport const getTodoHistory = async () => {\n  const { readDatabase } = useDb();\n  try {\n    const database = await readDatabase();\n    const remoteDatabase = database && database.history;\n    const localDatabase = await localForage.getItem(DB_TODOS_HISTORY_KEY);\n    const store = remoteDatabase || localDatabase;\n    if (!store) {\n      await localForage.setItem(DB_TODOS_HISTORY_KEY, {});\n      return {};\n    }\n    return store;\n  } catch (e) {}\n};\n\nexport function formatDate(date) {\n  const parsedDate = moment(date);\n  const year = parsedDate.year();\n  const month = parsedDate.month();\n  const day = parsedDate.date();\n  return `${month}-${day}-${year}`;\n}\n\nexport function useGlobalState() {\n  return useContext(Store);\n}\n\nexport const getTodos = async () => {\n  const { readDatabase } = useDb();\n  try {\n    const database = await readDatabase();\n    const remoteDatabase = database && database.todos;\n    const localDatabase = await localForage.getItem(DB_TODOS_KEY);\n    const store = remoteDatabase || localDatabase;\n    if (!store) {\n      await localForage.setItem(DB_TODOS_KEY, DEFAULT_TODOS);\n    }\n    return store || DEFAULT_TODOS;\n  } catch (e) {}\n};\n\nexport function useFilters(filters = {}) {\n  const [currentFilters, setFilters] = useState(filters);\n\n  const addFilter = name => setFilters([...currentFilters, name]);\n  const removeFilter = name =>\n    setFilters(currentFilters.filter(f => f !== name));\n  const isFilterActive = name => currentFilters.includes(name);\n  const toggleFilter = name =>\n    isFilterActive(name) ? removeFilter(name) : addFilter(name);\n\n  return {\n    filters,\n    currentFilters,\n    isFilterActive,\n    toggleFilter,\n    setFilters: filters => setFilters(Object.keys(filters)),\n  };\n}\n\nexport const generateTodayFilter = (today = moment().day()) => ({ days }) => {\n  return days.includes(today);\n};\n\nconst Day = 'Day';\n\n// export const filterMoreRecentTodos = ({ createdAt }) =>\nexport const requiredFilters = day => [];\nexport const getTodoFilters = ({ day } = {}) => {\n  return {\n    [Day]: generateTodayFilter(day),\n  };\n};\n\nexport function useTodoList(defaultTodos = [], day = moment()) {\n  const [todos, setTodos] = useState(defaultTodos);\n  const getFilters = () => getTodoFilters({ day: day.get('day') });\n  const { currentFilters, setFilters, ...filterProps } = useFilters(\n    Object.keys(getFilters())\n  );\n\n  const activeFilters = [...currentFilters.map(k => getFilters()[k])];\n  const filteredTodos = todos.filter(t => activeFilters.every(f => f(t)));\n\n  useEffect(\n    () => {\n      localForage.setItem(DB_TODOS_KEY, todos);\n    },\n    [todos]\n  );\n\n  const addTodo = todo => {\n    const generateId = makeUniqueIdGenerator('todo', todos.length);\n    const newTodos = [...todos, { id: generateId(), ...todo }];\n    setTodos(newTodos);\n  };\n\n  const toggleTodo = index => {\n    const newTodos = [...todos];\n    newTodos[index].isCompleted = !newTodos[index].isCompleted;\n    setTodos(newTodos);\n  };\n\n  const removeTodo = todoId => {\n    setTodos(todos.filter(id => id !== todoId));\n  };\n\n  const updateTodo = newTodo => {\n    const newTodos = todos.map(todo => {\n      if (newTodo.id !== todo.id) return todo;\n      return { ...todo, ...newTodo };\n    });\n    setTodos(newTodos);\n  };\n\n  return {\n    todos: filteredTodos,\n    allTodos: todos,\n    updateTodo,\n    removeTodo,\n    toggleTodo,\n    addTodo,\n    ...filterProps,\n  };\n}\n\nexport { useDayBrowser } from './useDayBrowser';\nexport { useTodoHistory } from './useTodoHistory';\nexport { useDb } from './useDb';\n","import React, { useState } from 'react';\nimport {\n  DAYS,\n  ALL_DAYS_SELECTED,\n  getDay,\n  dayNamesEnglish,\n  everyDay,\n} from 'shared';\n\nexport const messages = {\n  allDaysLabel: 'All days of the week',\n};\n\nexport default function DayPicker({ defaultSelectedDays, onSetSelectedDays }) {\n  const [selectedDays, setSelectedDays] = useState(defaultSelectedDays);\n  const isDaySelected = day => selectedDays.includes(getDay(day));\n  const allDaysChecked = ALL_DAYS_SELECTED.every(day =>\n    selectedDays.includes(day)\n  );\n  function syncDays(nextDays) {\n    setSelectedDays(nextDays);\n    onSetSelectedDays(nextDays);\n  }\n  function toggleCheckDay({ target }) {\n    const day = DAYS[target.value];\n    let nextDays;\n    if (!isDaySelected(target.value)) {\n      nextDays = [...selectedDays, day];\n    } else {\n      nextDays = selectedDays.filter(d => d !== day);\n    }\n    syncDays(nextDays);\n  }\n  return (\n    <fieldset>\n      <legend>Day</legend>\n      <label>\n        <input\n          type=\"checkbox\"\n          value={everyDay}\n          checked={allDaysChecked}\n          onChange={() => syncDays(allDaysChecked ? [] : ALL_DAYS_SELECTED)}\n        />\n        {messages.allDaysLabel}\n      </label>\n      &nbsp;â€”&nbsp;\n      {dayNamesEnglish.map(day => (\n        <label key={day}>\n          <input\n            type=\"checkbox\"\n            value={day}\n            checked={isDaySelected(day)}\n            onChange={toggleCheckDay}\n          />\n          {day}\n        </label>\n      ))}\n    </fieldset>\n  );\n}\n","import React, { useState } from 'react';\nimport { ALL_DAYS_SELECTED } from 'shared';\nimport DayPicker from 'app/DayPicker';\nexport const TODO_PLACEHOLDER = 'Climb Mt Rainier';\n\nexport const messages = {\n  editLabel: 'Edit',\n  saveLabel: 'Save',\n  todoTextPlaceholder: 'Climb Mt Rainier',\n};\n\nexport default function TodoForm({ cancel, todo, save, defaultValue = '' }) {\n  const [value, setValue] = useState(defaultValue);\n  const [selectedDays, setSelectedDays] = useState(\n    todo ? todo.days : ALL_DAYS_SELECTED\n  );\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    if (!value) return;\n    save({\n      text: value,\n      days: selectedDays,\n    });\n    setValue('');\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <label>\n        Todo&nbsp;\n        <input\n          autoFocus\n          type=\"text\"\n          className=\"input\"\n          placeholder={messages.todoTextPlaceholder}\n          value={value}\n          onChange={e => setValue(e.target.value)}\n        />\n      </label>\n      {!!value && (\n        <DayPicker\n          defaultSelectedDays={selectedDays}\n          onSetSelectedDays={setSelectedDays}\n        />\n      )}\n      <button type=\"submit\">{messages.saveLabel}</button>\n      {!!defaultValue && <button onClick={cancel}>Cancel</button>}\n    </form>\n  );\n}\n","import React, { useState } from 'react';\nimport TodoForm from 'app/TodoForm';\n\nexport const messages = {\n  editLabel: 'Edit',\n  deleteLabel: 'Remove',\n};\n\nexport const generateAriaLabelForDeleteButton = ({ text }) =>\n  `${messages.deleteLabel} ${text}`;\n\nexport const todoAriaLabelPart1 = 'Mark';\nexport const todoAriaLabelPart2 = 'as completed';\nexport const generateAriaLabelForTodo = ({ text }) =>\n  `${todoAriaLabelPart1} ${text} ${todoAriaLabelPart2}`;\nexport const generateAriaLabelForEditTodoButton = ({ text }) => `Edit ${text}`;\n\nexport default function TodoListItem({\n  isCompleted,\n  todo,\n  toggleTodo,\n  removeTodo,\n  updateTodo,\n}) {\n  const [isEditing, setIsEditing] = useState(false);\n  const setEditing = () => setIsEditing(true);\n  const setNotEditing = () => setIsEditing(false);\n  if (isEditing) {\n    return (\n      <TodoForm\n        todo={todo}\n        save={update => {\n          updateTodo({\n            ...todo,\n            ...update,\n          });\n          setNotEditing();\n        }}\n        defaultValue={todo.text}\n        cancel={setNotEditing}\n      />\n    );\n  }\n  return (\n    <div\n      style={{\n        textDecoration: isCompleted ? 'line-through' : '',\n      }}\n    >\n      <input\n        aria-label={generateAriaLabelForTodo(todo)}\n        type=\"checkbox\"\n        checked={isCompleted}\n        onChange={toggleTodo}\n      />\n      {todo.text}\n\n      <div>\n        <button\n          aria-label={generateAriaLabelForEditTodoButton(todo)}\n          onClick={setEditing}\n        >\n          {messages.editLabel}\n        </button>\n        <button\n          aria-label={generateAriaLabelForDeleteButton(todo)}\n          onClick={() => removeTodo(todo)}\n        >\n          {messages.deleteLabel}\n        </button>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { useGlobalState, useDayBrowser } from 'shared';\n\nexport default function DayBrowser() {\n  const { state } = useGlobalState();\n  const { currentDay } = state;\n  const { goToNextDay, goToPreviousDay, goToToday } = useDayBrowser();\n  return (\n    <div>\n      <button onClick={goToPreviousDay}>Prev</button>\n      <button onClick={goToToday}>Today</button>\n      {currentDay.format('dddd, MMMM Do YYYY')}\n      <button onClick={goToNextDay}>Next</button>\n    </div>\n  );\n}\n","import moment from 'moment';\nimport { useGlobalState } from 'shared';\n\nexport function useDayBrowser(defaultDay = moment()) {\n  const { state, setState } = useGlobalState();\n  const { currentDay } = state;\n  const setDay = day => setState({ currentDay: day });\n  const goToNextDay = () => setDay(currentDay.add(1, 'day'));\n  const goToPreviousDay = () => setDay(currentDay.subtract(1, 'day'));\n  const goToToday = () => setDay(moment());\n  return {\n    goToNextDay,\n    goToPreviousDay,\n    goToToday,\n  };\n}\n","import React, { useEffect } from 'react';\nimport TodoForm from 'app/TodoForm';\nimport TodoListItem from 'app/TodoListItem';\nimport { useTodoList, useTodoHistory, useDb } from 'shared';\nimport DayBrowser from 'app/DayBrowser';\nimport { useGlobalState } from 'shared';\n\nexport default function TodoList({\n  defaultTodos = [],\n  defaultHistory,\n  defaultDay,\n}) {\n  const { saveDatabase } = useDb();\n  const { state } = useGlobalState();\n  const { currentDay } = state;\n  const {\n    allTodos,\n    todos,\n    filters,\n    toggleFilter,\n    isFilterActive,\n    addTodo,\n    removeTodo,\n    updateTodo,\n  } = useTodoList(defaultTodos, currentDay);\n  const { history, toggleTodoForDay, isCompletedForDay } = useTodoHistory(\n    defaultHistory\n  );\n  const isTodoCompleted = ({ id }) => isCompletedForDay(id, currentDay);\n\n  useEffect(\n    () => {\n      saveDatabase({\n        data: {\n          history,\n          todos: allTodos,\n        },\n      });\n    },\n    [history, allTodos]\n  );\n\n  return (\n    <div>\n      <DayBrowser />\n      <div>\n        Filters\n        {filters.map(name => (\n          <label key={name}>\n            {name}\n            <input\n              type=\"checkbox\"\n              checked={isFilterActive(name)}\n              onChange={() => toggleFilter(name)}\n            />\n          </label>\n        ))}\n        <ul>\n          {todos.map((todo, index) => (\n            <li key={index}>\n              <TodoListItem\n                index={index}\n                todo={todo}\n                isCompleted={isTodoCompleted(todo)}\n                toggleTodo={() => toggleTodoForDay(todo.id, currentDay)}\n                removeTodo={removeTodo}\n                updateTodo={updateTodo}\n              />\n            </li>\n          ))}\n          <li>\n            <TodoForm save={addTodo} />\n          </li>\n        </ul>\n        <div style={{ background: 'lavender', padding: 20, float: 'right' }}>\n          <pre>todos: {JSON.stringify(allTodos, null, 2)}</pre>\n          <pre>history: {JSON.stringify(history, null, 2)}</pre>\n          <pre>state: {JSON.stringify(state, null, 2)}</pre>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from 'react';\nimport isEqual from 'lodash/isEqual';\nimport isEmpty from 'lodash/isEmpty';\nimport localForage from 'localforage';\nimport { DB_TODOS_HISTORY_KEY, formatDate } from 'shared';\n\nexport function useTodoHistory(defaultHistory = {}) {\n  let lastHistory = defaultHistory;\n  const [history, setHistory] = useState(defaultHistory);\n\n  useEffect(() => {\n    if (!isEqual(lastHistory, history) && !isEmpty(history)) {\n      localForage.setItem(DB_TODOS_HISTORY_KEY, history);\n    }\n  });\n\n  const getDayHistory = date => history[date] || [];\n  const isCompletedForDay = (todoId, day) =>\n    getDayHistory(formatDate(day)).includes(todoId);\n\n  const toggleTodoForDay = (todoId, day) => {\n    const date = formatDate(day);\n    if (!date) return;\n    const existingDayHistory = getDayHistory(date);\n    const isCompletedForDay = existingDayHistory.includes(todoId);\n    const nextTodoHistory = isCompletedForDay\n      ? existingDayHistory.filter(t => t !== todoId)\n      : [...existingDayHistory, todoId];\n    const nextHistory = {\n      ...history,\n      [date]: nextTodoHistory,\n    };\n    lastHistory = nextHistory;\n    setHistory(nextHistory);\n  };\n\n  return {\n    history,\n    isCompletedForDay,\n    toggleTodoForDay,\n  };\n}\n","import React, { Suspense } from 'react';\nimport { getTodos, getTodoHistory, useDb } from 'shared';\nimport AppProviders from 'app/Providers';\nimport { unstable_createResource as createResource } from 'react-cache';\nimport TodoList from 'app/TodoList';\n\nconst todosResource = createResource(getTodos);\nconst todosHistoryResource = createResource(getTodoHistory);\n\nconst Fallback = () => <div>Loading...</div>;\n\nconst LiveTodoList = () => {\n  const todos = todosResource.read();\n  const history = todosHistoryResource.read();\n  return <TodoList defaultTodos={todos} defaultHistory={history} />;\n};\n\nconst User = () => {\n  const { authUrl, client, logout, user } = useDb();\n\n  if (user) {\n    const { name } = user;\n    return (\n      <div>\n        Logged in as: {name.display_name}&nbsp;\n        <button onClick={logout}>Logout</button>\n      </div>\n    );\n  }\n\n  return client ? (\n    'Fetching account...'\n  ) : (\n    <a href={authUrl}>Login to Dropbox</a>\n  );\n};\n\nexport default function App(props) {\n  return (\n    <AppProviders>\n      <User />\n      <Suspense fallback={<Fallback />}>\n        <LiveTodoList />\n      </Suspense>\n    </AppProviders>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      console.log(\n        'bailing on registering service worker!!!!!',\n        publicUrl,\n        publicUrl.origin\n      );\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.register();\n"],"sourceRoot":""}